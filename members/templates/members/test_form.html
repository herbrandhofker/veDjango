<!DOCTYPE html>
<html>
<head>
    <title>Test Aanmeldformulier</title>
</head>
<body>
    <h1>Test Aanmeldformulier</h1>
    <form id="testForm">
        {% csrf_token %}  <!-- Dit voegt het CSRF token toe -->
        <div>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div>
            <label for="name">Naam:</label>
            <input type="text" id="name" name="name" required>
        </div>
        <div>
            <label for="property_type">Type woning:</label>
            <select id="property_type" name="property_type" required>
                <option value="huurwoning">Huurwoning</option>
                <option value="koopwoning">Koopwoning</option>
                <option value="kantoor">Kantoor</option>
            </select>
        </div>
        <button type="submit">Verstuur</button>
    </form>

    <div id="response" style="margin-top: 20px;"></div>

    <script>
        document.getElementById("testForm").addEventListener("submit", function(event) {
            event.preventDefault();
            
            const formData = {
                email: document.getElementById("email").value,
                name: document.getElementById("name").value,
                property_type: document.getElementById("property_type").value,
                street: "Teststraat",
                house_number: "123",
                postal_code: "1234 AB",
                city: "Lelystad"
            };
            
            // Haal het CSRF token op uit het formulier
            const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
            
            fetch('/api/members/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrftoken
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("response").innerHTML = 
                    `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            })
            .catch(error => {
                document.getElementById("response").innerHTML = 
                    `<p style="color: red;">Fout: ${error}</p>`;
            });
        });
    </script>
</body>
</html>